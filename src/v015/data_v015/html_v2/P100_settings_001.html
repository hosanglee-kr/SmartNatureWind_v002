<!-- P100_settings_001.html -->

<!doctype html>
<html lang="ko">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>⚙️ Smart Nature Wind 시스템 설정</title>

	<link rel="stylesheet" href="./P000_common_001.css">
	<link rel="stylesheet" href="./P100_settings_001.css">
</head>

<body>

	<header class="nav-bar">
		<div class="nav-container">
			<a href="./P040_dashboard_002.html" class="nav-logo">Smart Wind</a>
			<nav>
				<ul class="nav-menu" id="navMenu">
					</ul>
			</nav>
		</div>
	</header>

	<!-- <header class="nav-bar">
		<div class="nav-container">
			<a href="./SC10_dashboard_001.html" class="nav-logo">Smart Wind</a>
			<nav>
				<ul class="nav-menu">
					<li><a href="./SC10_dashboard_001.html">대시보드</a></li>
					<li><a href="./SC10_chart_t2_007.html">차트 모니터링</a></li>
					<li><a href="./SC10_sim_details_001.html">시뮬 설정</a></li>
					<li><a href="./SC10_profile_001.html">프로파일 관리</a></li>
					<li><a href="./SC10_schedules_t2_001.html">스케줄 관리</a></li>
					<li><a href="./SC10_user_001.html">사용자 프로필</a></li>
					<li><a href="./P100_settings_001.html" class="active">시스템 설정</a></li>
				</ul>
			</nav>
		</div>
	</header> -->

	<div class="wrap">
		<h1>시스템 설정 및 관리</h1>

		<div class="grid settings-grid">

			<div class="col-6 card">
				<strong class="section-title">🔑 API Key 및 인증 관리</strong>
				<p class="muted">API 호출에 사용되는 인증 키를 설정합니다.</p>
				<div class="form-group row tight middle">
					<span class="label">현재 키 상태:</span>
					<span id="apiKeyStatus" class="info-label warn">설정 필요</span>
				</div>
				<div class="actions">
					<button class="btn ok" id="btnSetApiKey">API Key 변경 / 설정</button>
					<button class="btn" id="btnCheckAuth">인증 테스트</button>
				</div>
			</div>

			<div class="col-6 card">
				<strong class="section-title">ℹ️ 시스템 정보 및 진단</strong>
				<div class="system-info">
					<div class="info-item">
						<span class="label">펌웨어:</span>
						<span id="fwVersion">N/A</span>
					</div>
					<div class="info-item">
						<span class="label">Uptime:</span>
						<span id="uptime">N/A</span>
					</div>
					<div class="info-item">
						<span class="label">Heap Free:</span>
						<span id="heapFree">N/A</span>
					</div>
				</div>
				<div class="actions">
					<button class="btn" id="btnCheckUpdate">⬆️ 펌웨어 확인</button>
                    <button class="btn" id="btnRefreshInfo">🔄 갱신</button>
				</div>
			</div>

            <div class="col-6 card">
                <strong class="section-title">⚙️ 일반 설정</strong>
                <form id="generalSystemForm">
                    <div class="form-group tight">
                        <label for="deviceName">장치 이름 (Hostname)</label>
                        <input type="text" id="deviceName" name="deviceName" placeholder="SmartNatureWind">
                    </div>
                    <div class="form-group tight">
                        <label for="logLevel">로그 레벨</label>
                        <select id="logLevel" name="logLevel">
                            <option value="DEBUG">DEBUG (개발용)</option>
                            <option value="INFO">INFO (기본)</option>
                            <option value="WARN">WARN</option>
                            <option value="ERROR">ERROR</option>
                        </select>
                    </div>
                    <div class="actions">
                        <button type="submit" class="btn ok">일반 설정 저장</button>
                    </div>
                </form>
            </div>

            <div class="col-12 card">
                <strong class="section-title">💨 하드웨어 및 팬 제어 한계</strong>
                <p class="muted">팬의 작동 범위 및 센서 관련 세부 설정입니다.</p>
                <form id="fanConfigForm">
                    <div class="grid timing-grid">
                        <div class="col-3 form-group tight">
                            <label>기동 최소 (%)</label>
                            <input type="number" id="startPercentMin" name="startPercentMin" min="0" max="100">
                        </div>
                        <div class="col-3 form-group tight">
                            <label>쾌적 최소 (%)</label>
                            <input type="number" id="comfortPercentMin" name="comfortPercentMin" min="0" max="100">
                        </div>
                        <div class="col-3 form-group tight">
                            <label>쾌적 최대 (%)</label>
                            <input type="number" id="comfortPercentMax" name="comfortPercentMax" min="0" max="100">
                        </div>
                        <div class="col-3 form-group tight">
                            <label>강풍 최대 (%)</label>
                            <input type="number" id="hardPercentMax" name="hardPercentMax" min="0" max="100">
                        </div>
                    </div>
                    <div class="actions top-margin">
                        <button type="submit" class="btn ok">팬 한계 설정 저장</button>
                    </div>
                </form>
            </div>

            <div class="col-12 card">
                <strong class="section-title">🔌 하드웨어 핀 및 센서 상세 설정</strong>
                <p class="muted">각 센서의 사용 여부 및 연결된 GPIO 핀 번호를 설정합니다.</p>
                <form id="hwConfigForm">
                    <div class="grid timing-grid">
                        <!-- Fan PWM -->
                        <div class="col-4 hw-section">
                            <strong class="sub-title">팬 PWM</strong>
                            <div class="form-group tight">
                                <label>핀 (GPIO)</label>
                                <input type="number" id="hwFanPin" name="hwFanPin">
                            </div>
                            <div class="form-group tight">
                                <label>주파수 (Hz)</label>
                                <input type="number" id="hwFanFreq" name="hwFanFreq">
                            </div>
                        </div>
                        <!-- PIR -->
                        <div class="col-4 hw-section">
                            <strong class="sub-title">PIR (모션)</strong>
                            <div class="form-group tight row middle">
                                <label><input type="checkbox" id="hwPirEnabled" name="hwPirEnabled"> 사용</label>
                            </div>
                            <div class="form-group tight">
                                <label>핀 (GPIO)</label>
                                <input type="number" id="hwPirPin" name="hwPirPin">
                            </div>
                            <div class="form-group tight">
                                <label>지연(초)</label>
                                <input type="number" id="hwPirHold" name="hwPirHold">
                            </div>
                        </div>
                        <!-- Temp/Hum -->
                        <div class="col-4 hw-section">
                            <strong class="sub-title">온습도</strong>
                            <div class="form-group tight row middle">
                                <label><input type="checkbox" id="hwThEnabled" name="hwThEnabled"> 사용</label>
                            </div>
                            <div class="form-group tight">
                                <label>핀 (GPIO)</label>
                                <input type="number" id="hwThPin" name="hwThPin">
                            </div>
                            <div class="form-group tight">
                                <label>타입</label>
                                <select id="hwThType" name="hwThType">
                                    <option value="DHT11">DHT11</option>
                                    <option value="DHT22">DHT22</option>
                                </select>
                            </div>
                        </div>
                        <!-- BLE -->
                        <div class="col-4 hw-section">
                            <strong class="sub-title">BLE 스캔</strong>
                            <div class="form-group tight row middle">
                                <label><input type="checkbox" id="hwBleEnabled" name="hwBleEnabled"> 사용</label>
                            </div>
                            <div class="form-group tight">
                                <label>주기(초)</label>
                                <input type="number" id="hwBleInterval" name="hwBleInterval">
                            </div>
                        </div>
                    </div>
                    <div class="actions top-margin">
                        <button type="submit" class="btn ok">하드웨어 설정 저장</button>
                    </div>
                </form>
            </div>

			<div class="col-12 card">
				<strong class="section-title">🌐 네트워크 상태 및 설정</strong>
				<div class="network-status grid timing-grid">
					<div class="col-4 info-item">
						<span class="label">연결 방식:</span>
						<span id="netMode" class="info-label ok">WiFi (STA)</span>
					</div>
					<div class="col-4 info-item">
						<span class="label">IP 주소:</span>
						<span id="ipAddress">0.0.0.0</span>
					</div>
					<div class="col-4 info-item">
						<span class="label">WiFi SSID:</span>
						<span id="wifiSsid">N/A</span>
					</div>
				</div>
				<div class="actions top-margin">
					<button class="btn" id="btnNetworkSetup">📶 WiFi/Ethernet 설정</button>
					<button class="btn" id="btnTimeSetup">⏰ 시간 및 NTP 설정</button>
				</div>
			</div>

			<div class="col-12 card">
				<strong class="section-title">⚠️ 장치 제어 및 관리</strong>
				<p class="muted">장치를 재부팅하거나 공장 초기화하는 기능입니다. 주의해서 사용하십시오.</p>
                <div class="form-group row tight middle">
                    <span class="label">설정 변경 상태:</span>
                    <span id="configDirtyStatus" class="info-label ok">저장됨</span>
                </div>
				<div class="actions">
					<button class="btn ok" id="btnConfigSave">💾 현재 설정 파일 저장</button>
                    <button class="btn" id="btnReloadConfig">🔄 설정 새로고침</button>
					<button class="btn warn" id="btnReboot">🔄 장치 재부팅</button>
					<button class="btn err" id="btnFactoryReset">💥 공장 초기화</button>
				</div>
			</div>

            <div class="col-12 card">
                <strong class="section-title">📜 최근 시스템 로그</strong>
                <div id="logViewer" class="scan-results" style="height: 150px; font-family: monospace; font-size: 0.85em; white-space: pre-wrap;">
                    로그를 불러오는 중...
                </div>
                <div class="actions">
                    <button class="btn" id="btnRefreshLogs">🔄 로그 갱신</button>
                </div>
            </div>
		</div>

		<div class="muted">© 2540.kr SmartNatureWind (v001 System Settings UI)</div>
	</div>

	<div id="apiKeyModal" class="modal-overlay" style="display:none;">
		<div class="modal-content">
			<div class="modal-header">
				<h2 id="apiKeyModalTitle">API Key 설정</h2>
				<button class="btn-close" id="btnCloseApiKeyModal">❌</button>
			</div>
			<form id="apiKeyForm">
				<div class="form-group">
					<label for="newApiKey">새로운 API Key 입력</label>
					<input type="text" id="newApiKey" name="newApiKey" placeholder="여기에 키를 입력하세요" required>
				</div>
				<div class="modal-actions">
					<button type="submit" class="btn ok" id="btnSaveApiKey">🔑 키 저장 및 적용</button>
					<button type="button" class="btn" id="btnCancelApiKeyModal">취소</button>
				</div>
			</form>
		</div>
	</div>

	<!-- Network Setup Modal -->
	<div id="networkModal" class="modal-overlay" style="display:none;">
		<div class="modal-content">
			<div class="modal-header">
				<h2>네트워크 설정</h2>
				<button class="btn-close" id="btnCloseNetworkModal">❌</button>
			</div>
			<form id="networkForm">
				<div class="form-group">
					<label for="networkMode">모드 선택</label>
					<select id="networkMode" name="mode">
						<option value="1">STA (기존 공유기 연결)</option>
						<option value="0">AP (독자망 구성)</option>
						<option value="2">AP + STA (혼합)</option>
					</select>
				</div>
				<div class="form-group">
					<label for="networkSsid">SSID (이름)</label>
					<input type="text" id="networkSsid" name="ssid" placeholder="WiFi 이름">
				</div>
				<div class="form-group">
					<label for="networkPassword">비밀번호</label>
					<input type="password" id="networkPassword" name="password" placeholder="WiFi 암호">
				</div>
                <div class="form-group">
                    <button type="button" class="btn" id="btnWifiScan">🔍 주변 WiFi 검색</button>
                    <div id="wifiScanResults" class="scan-results" style="display:none; margin-top:10px;">
                        <ul id="wifiList"></ul>
                    </div>
                </div>
				<div class="modal-actions">
					<button type="submit" class="btn ok">저장 및 적용</button>
					<button type="button" class="btn" id="btnCancelNetworkModal">취소</button>
				</div>
			</form>
		</div>
	</div>

	<!-- Time Setup Modal -->
	<div id="timeModal" class="modal-overlay" style="display:none;">
		<div class="modal-content">
			<div class="modal-header">
				<h2>시간 및 NTP 설정</h2>
				<button class="btn-close" id="btnCloseTimeModal">❌</button>
			</div>
			<form id="timeForm">
				<div class="form-group">
					<label for="ntpServer">NTP 서버 주소</label>
					<input type="text" id="ntpServer" name="ntpServer" value="pool.ntp.org">
				</div>
                <div class="form-group">
                    <label for="syncIntervalMin">동기화 주기 (분)</label>
                    <input type="number" id="syncIntervalMin" name="syncIntervalMin" value="60">
                </div>
				<div class="form-group">
					<label for="timezoneOffset">타임존 (Timezone)</label>
                    <select id="timezoneOffset" name="timezoneOffset">
                        <option value="Asia/Seoul">Asia/Seoul (한국 표준시)</option>
                        <option value="UTC">UTC (세계 협정시)</option>
                        <option value="America/New_York">America/New_York</option>
                        <option value="Europe/London">Europe/London</option>
                    </select>
					<!-- <input type="number" id="timezoneOffset" name="timezoneOffset" value="9" placeholder="UTC offset (예: 9)"> -->
				</div>
				<div class="modal-actions">
					<button type="submit" class="btn ok">저장</button>
					<button type="button" class="btn" id="btnCancelTimeModal">취소</button>
				</div>
			</form>
		</div>
	</div>


	<div id="loadingOverlay" style="display:none;">
		<div class="spinner"></div>
	</div>
	<div id="toastContainer"></div>

	<script src="./P000_common_006.js" defer></script>
	<script src="./P100_settings_002.js" defer></script>
</body>

</html>

