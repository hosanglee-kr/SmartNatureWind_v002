<!doctype html>
<html lang="ko">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>🌬️ Smart Nature Wind 유저 프로파일 관리 (t2_003)</title>

  <link rel="stylesheet" href="./P000_common_001.css">
  <link rel="stylesheet" href="./P085_userProfiles_t2_003.css">
</head>

<body>
  <!-- 상단 네비게이션 -->
  <header class="nav-bar">
    <div class="nav-container">
      <a href="./P040_dashboard_002.html" class="nav-logo">Smart Wind</a>
      <nav>
        <ul class="nav-menu" id="navMenu">
          <!-- /api/v1/menu 기반 자동 생성됨 -->
        </ul>
      </nav>
    </div>
  </header>

  <div class="wrap">
    <h1>유저 프로파일 관리 (t2_003)</h1>

    <section class="card control-panel">
      <div class="row">
        <strong class="section-title">등록된 유저 프로파일 목록</strong>
        <div class="right tight">
          <button class="btn ok" id="btnCreateNewProfile">➕ 새 프로파일 생성</button>
          <button class="btn" id="btnRefreshList">🔄 목록 새로고침</button>
          <button class="btn" id="btnSaveAllConfig">전체 설정 저장</button>
        </div>
      </div>

      <div class="profile-list-container">
        <table class="profile-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>No</th>
              <th>프로파일 이름</th>
              <th>Segment 수</th>
              <th>반복</th>
              <th>AutoOff</th>
              <th>Motion</th>
              <th>상태</th>
              <th>액션</th>
            </tr>
          </thead>
          <tbody id="profileListBody"></tbody>
        </table>

        <p id="noProfileMessage" class="muted" style="display:none;">등록된 유저 프로파일이 없습니다.</p>
      </div>
    </section>

    <div class="muted">© 2540.kr SmartNatureWind (v003 User Profile Manager UI)</div>
  </div>

  <!-- ============================================================
        유저 프로파일 생성/수정 모달
       ============================================================ -->
  <div id="profileModal" class="modal-overlay" style="display:none;">
    <div class="modal-content wide-modal">
      <div class="modal-header">
        <h2 id="modalTitle">유저 프로파일 생성</h2>
        <button class="btn-close" id="btnCloseModal">❌</button>
      </div>

      <form id="profileForm">
        <input type="hidden" id="profileId">

        <section class="card">
          <div class="form-group">
            <label for="profileNo">프로파일 번호(profileNo)</label>
            <input type="number" id="profileNo" min="1" max="255">
          </div>

          <div class="form-group">
            <label for="profileName">프로파일 이름</label>
            <input type="text" id="profileName" required>
          </div>

          <div class="form-inline">
            <label for="profileEnabled">사용 여부</label>
            <input type="checkbox" id="profileEnabled" checked>
          </div>

          <div class="grid profile-settings-grid">
            <div class="form-group">
              <label>Segments 반복 사용</label>
              <input type="checkbox" id="repeatSegments" checked>
            </div>

            <div class="form-group">
              <label>반복 횟수 (repeatCount)</label>
              <input type="number" id="repeatCount" min="0" max="20" value="1">
            </div>
          </div>
        </section>

        <!-- ============================================================
             Segment 목록 + Segment 추가
           ============================================================ -->
        <section class="card">
          <h3>Segments</h3>
          <button type="button" class="btn ok" id="btnAddSegment">➕ Segment 추가</button>

          <div id="segmentListContainer" class="segment-list"></div>
        </section>

        <!-- ============================================================
             AutoOff (B안: Foldable)
           ============================================================ -->
        <section class="card fold">
          <div class="fold-header" data-fold="autoOffFold">
            <strong>AutoOff 설정</strong>
            <span class="fold-icon">▼</span>
          </div>

          <div id="autoOffFold" class="fold-body">
            <div class="grid">
              <div class="form-group">
                <label>타이머 사용</label>
                <input type="checkbox" id="autoOff_timer_enabled">
              </div>
              <div class="form-group">
                <label>타이머(분)</label>
                <input type="number" id="autoOff_timer_minutes" min="0" max="1440">
              </div>
            </div>

            <div class="grid">
              <div class="form-group">
                <label>시간 종료 사용</label>
                <input type="checkbox" id="autoOff_offTime_enabled">
              </div>
              <div class="form-group">
                <label>종료 시간(HH:MM)</label>
                <input type="time" id="autoOff_offTime_time">
              </div>
            </div>

            <div class="grid">
              <div class="form-group">
                <label>온도 종료 사용</label>
                <input type="checkbox" id="autoOff_offTemp_enabled">
              </div>
              <div class="form-group">
                <label>종료 온도(℃)</label>
                <input type="number" id="autoOff_offTemp_temp" step="0.1" min="0" max="50">
              </div>
            </div>
          </div>
        </section>

        <!-- ============================================================
             Motion 설정
           ============================================================ -->
        <section class="card fold">
          <div class="fold-header" data-fold="motionFold">
            <strong>Motion 설정</strong>
            <span class="fold-icon">▼</span>
          </div>

          <div id="motionFold" class="fold-body">

            <div class="form-inline">
              <label>PIR 사용</label>
              <input type="checkbox" id="motion_pir_enabled">
            </div>
            <div class="form-group">
              <label>PIR holdSec</label>
              <input type="number" id="motion_pir_hold_sec" min="0" max="3600">
            </div>

            <div class="divider"></div>

            <div class="form-inline">
              <label>BLE 사용</label>
              <input type="checkbox" id="motion_ble_enabled">
            </div>

            <div class="grid">
              <div class="form-group">
                <label>BLE RSSI Threshold</label>
                <input type="number" id="motion_ble_rssi_threshold" min="-120" max="0">
              </div>

              <div class="form-group">
                <label>BLE holdSec</label>
                <input type="number" id="motion_ble_hold_sec" min="0" max="3600">
              </div>
            </div>
          </div>
        </section>

        <!-- ============================================================
             저장/취소
           ============================================================ -->
        <div class="modal-actions">
          <button type="submit" class="btn ok">💾 저장</button>
          <button type="button" class="btn" id="btnCancelModal">취소</button>
        </div>

      </form>
    </div>
  </div>

  <!-- 공통 요소 -->
  <div id="loadingOverlay" style="display:none;">
    <div class="spinner"></div>
  </div>
  <div id="toastContainer"></div>

  <script src="./P000_common_006.js" defer></script>
  <script src="./P085_userProfiles_t2_003.js" defer></script>
</body>

</html>

